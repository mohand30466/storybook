const test = require('tape')
const ploy = require('../../../')
const minify = require('../')
const fs = require('fs')
const path = require('path')

test.onFinish(() => process.exit())

const file = fs.readFileSync(path.join(__dirname, 'file.js')).toString()

test('minify', { timeout: 1e4 }, t => {
  console.log('file', file.length)

  ploy.set({
    cwd: __dirname,
    tasks: {
      inject: [ minify ],
      minify: {
        type: 'minify',
        options: {
          file
        }
      }
    }
  })

  ploy.on('error', data => console.log(data))
})
