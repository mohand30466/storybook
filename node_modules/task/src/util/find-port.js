const net = require('net')
const findPort = port => new Promise(resolve => {
  const server = net.createServer()
  server.on('error', e => resolve(findPort(++port)))
  server.listen(port, e => {
    server.once('close', () => resolve(port))
    server.close()
  })
})

module.exports = findPort
